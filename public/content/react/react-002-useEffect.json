{
    "id": "react-002-useeffect",
    "title": "useEffect Hook",
    "description": "Handle side effects: data fetching, subscriptions, and DOM updates",
    "duration": 10,
    "difficulty": "beginner",
    "tags": ["hooks", "side-effects", "lifecycle"],
    "prerequisites": ["react-001-usestate"],
    "unlocks": ["react-003-props"],
    "xp": 75,
    "steps": {
      "refresher": {
        "type": "markdown",
        "title": "What is useEffect?",
        "content": "# useEffect Hook\n\n## What problem does it solve?\n\nFunctional components don't have lifecycle methods like class components. **useEffect** lets you perform side effects after render.\n\n## Common Use Cases\n\n- Fetching data from an API\n- Setting up subscriptions\n- Manually changing the DOM\n- Starting timers\n\n## Syntax\n\n```javascript\nuseEffect(() => {\n  // effect code\n  return () => {\n    // cleanup (optional)\n  };\n}, [dependencies]);\n```\n\n- Runs after every render by default\n- Skip runs with empty `[]` (only once on mount)\n- Cleanup runs before next effect or unmount\n\n**Let's see it in action! ‚Üí**"
      },
      "positive": {
        "type": "interactive-code",
        "title": "‚úÖ Positive Case: Fetch Users",
        "description": "Fetches and displays a list of users from an API on mount.",
        "code": "import { useState, useEffect } from 'react';\n\nfunction UserList() {\n  const [users, setUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetch('https://jsonplaceholder.typicode.com/users')\n      .then(res => res.json())\n      .then(data => {\n        setUsers(data);\n        setLoading(false);\n      });\n  }, []);\n\n  if (loading) return <p className=\"p-6 text-center\">Loading users...</p>;\n\n  return (\n    <div className=\"p-6\">\n      <h2 className=\"text-2xl font-bold mb-4\">Users</h2>\n      <ul className=\"space-y-2\">\n        {users.slice(0, 5).map(user => (\n          <li key={user.id} className=\"p-3 bg-gray-100 rounded\">\n            {user.name} ({user.email})\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nexport default UserList;",
        "showPreview": true,
        "explanation": "**Key Points:**\n- Empty dependency array `[]` ‚Üí runs only once on mount\n- Fetch happens after first render\n- Cleanup not needed here (no subscription)\n- Loading state improves UX"
      },
      "negative": {
        "type": "debug-quiz",
        "title": "üêõ Common Mistake: Infinite Loop",
        "description": "This component causes infinite re-renders. Can you spot why?",
        "code": "import { useState, useEffect } from 'react';\n\nfunction BadTimer() {\n  const [seconds, setSeconds] = useState(0);\n\n  useEffect(() => {\n    setTimeout(() => {\n      setSeconds(seconds + 1);\n    }, 1000);\n  });\n\n  return <div className=\"p-6\">Seconds: {seconds}</div>;\n}\n\nexport default BadTimer;",
        "question": "Why does this cause an infinite loop?",
        "options": [
          { "id": "a", "text": "setTimeout is not allowed in React", "isCorrect": false },
          { "id": "b", "text": "Missing dependency array causes effect to run every render", "isCorrect": true, "explanation": "‚úÖ Correct! Without dependencies, useEffect runs after EVERY render. setSeconds triggers a re-render ‚Üí effect runs again ‚Üí infinite loop." },
          { "id": "c", "text": "seconds should be in dependency array", "isCorrect": false },
          { "id": "d", "text": "useEffect can't use setTimeout", "isCorrect": false }
        ],
        "correctCode": "import { useState, useEffect } from 'react';\n\nfunction GoodTimer() {\n  const [seconds, setSeconds] = useState(0);\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setSeconds(s => s + 1);\n    }, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  return <div className=\"p-6 text-2xl\">Seconds: {seconds}</div>;\n}\n\nexport default GoodTimer;",
        "lesson": "**Always provide a dependency array.** Use `[]` for mount-only effects. Use functional updates `setSeconds(s => s + 1)` when depending on previous state."
      },
      "task": {
        "type": "coding-task",
        "title": "üõ†Ô∏è Your Turn: Live Clock",
        "description": "Build a digital clock that updates every second.",
        "requirements": [
          "Display current time in HH:MM:SS format",
          "Update every second",
          "Clean up on unmount",
          "Use useEffect properly"
        ],
        "starterCode": "import { useState, useEffect } from 'react';\n\nfunction Clock() {\n  const [time, setTime] = useState(new Date());\n\n  // TODO: Add useEffect\n\n  return (\n    <div className=\"p-10 text-center\">\n      <h1 className=\"text-5xl font-bold\">{time.toLocaleTimeString()}</h1>\n    </div>\n  );\n}\n\nexport default Clock;",
        "solution": "import { useState, useEffect } from 'react';\n\nfunction Clock() {\n  const [time, setTime] = useState(new Date());\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setTime(new Date());\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, []);\n\n  return (\n    <div className=\"p-10 text-center\">\n      <h1 className=\"text-5xl font-bold text-blue-600\">{time.toLocaleTimeString()}</h1>\n    </div>\n  );\n}\n\nexport default Clock;",
        "hints": [
          "Use setInterval instead of setTimeout",
          "Remember to clearInterval in cleanup",
          "Empty dependency array []"
        ]
      },
      "challenge": {
        "type": "coding-challenge",
        "title": "üèÜ Challenge: Window Size Tracker",
        "description": "Track and display the current window width and height in real time.",
        "requirements": [
          "Show current width √ó height",
          "Update on window resize",
          "Clean up event listener",
          "Debounce updates if possible (bonus)"
        ],
        "starterCode": "import { useState, useEffect } from 'react';\n\nfunction WindowSize() {\n  const [size, setSize] = useState({ width: 0, height: 0 });\n\n  // TODO: Add resize listener\n\n  return (\n    <div className=\"p-8 text-center\">\n      <p className=\"text-3xl\">{size.width} √ó {size.height}</p>\n    </div>\n  );\n}\n\nexport default WindowSize;",
        "solution": "import { useState, useEffect } from 'react';\n\nfunction WindowSize() {\n  const [size, setSize] = useState({\n    width: window.innerWidth,\n    height: window.innerHeight\n  });\n\n  useEffect(() => {\n    const handleResize = () => {\n      setSize({ width: window.innerWidth, height: window.innerHeight });\n    };\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  return (\n    <div className=\"p-8 text-center bg-gray-100 rounded-lg\">\n      <p className=\"text-4xl font-bold text-purple-600\">\n        {size.width} √ó {size.height}\n      </p>\n      <p className=\"mt-4 text-gray-600\">Resize the window to see updates!</p>\n    </div>\n  );\n}\n\nexport default WindowSize;",
        "hints": [
          "Use window.addEventListener('resize', ...)",
          "Don't forget to remove the listener in cleanup",
          "Initialize state with window.innerWidth/Height"
        ]
      }
    }
  }