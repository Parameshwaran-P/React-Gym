{
  "id": "react-018-usereducer",
  "title": "useReducer Hook",
  "description": "Manage complex state changes in a clear and predictable way",
  "duration": 12,
  "difficulty": "intermediate",
  "tags": ["react", "hooks", "state-management"],
  "prerequisites": ["react-017-context-api"],
  "unlocks": ["react-019-memoization"],
  "xp": 120,

  "steps": {
    "intro": {
      "type": "game-intro",
      "title": "Control State with Rules",
      "story": "State changes are happening everywhere and becoming hard to track.",
      "preview": "Learn to control state using clear rules."
    },

    "refresher": {
      "type": "markdown",
      "title": "Real-Life Example",
      "content": "# Bank Counter\n\nYou give request\n\nClerk checks rules\n\nThen updates balance\n\n---\n\nState does not change randomly.\nIt follows rules.\n\nThose rules are called a reducer."
    },

    "concept": {
      "type": "markdown",
      "title": "What is useReducer?",
      "content": "useReducer is used when:\n\n- State logic is complex\n- Many actions update state\n- useState becomes messy\n\nIt works using:\n- state\n- action\n- reducer function"
    },

    "concept2": {
      "type": "markdown",
      "title": "Reducer Logic",
      "content": "Reducer decides:\n\nIf action is X ➜ do this\n\nIf action is Y ➜ do that\n\nIt always returns **new state**."
    },

    "syntax": {
      "type": "markdown",
      "title": "useReducer Syntax",
      "content": "```\nconst [state, dispatch] = useReducer(reducer, initialState);\n```"
    },

    "positive": {
      "type": "interactive-code",
      "title": "Simple Counter with useReducer",
      "description": "Increase and decrease using actions.",
      "code": "import { useReducer } from 'react';\n\nfunction reducer(state, action) {\n  if (action === 'add') {\n    return state + 1;\n  }\n  if (action === 'remove') {\n    return state - 1;\n  }\n  return state;\n}\n\nfunction Counter() {\n  const [count, dispatch] = useReducer(reducer, 0);\n\n  return (\n    <div>\n      <p>{count}</p>\n      <button onClick={() => dispatch('add')}>Add</button>\n      <button onClick={() => dispatch('remove')}>Remove</button>\n    </div>\n  );\n}\n\nexport default Counter;",
      "showPreview": true,
      "explanation": "Reducer controls how state changes."
    },

    "concept3": {
      "type": "markdown",
      "title": "Why useReducer?",
      "content": "useState ➜ small logic\n\nuseReducer ➜ complex logic\n\nReducer makes code:\n- Predictable\n- Easy to debug\n- Scalable"
    },

    "negative": {
      "type": "debug-quiz",
      "title": "State Not Updating",
      "description": "Reducer returns nothing.",
      "code": "function reducer(state, action) {\n  if (action === 'add') {\n    state + 1;\n  }\n}",
      "question": "What is the mistake?",
      "options": [
        {
          "id": "a",
          "text": "Reducer must return new state",
          "isCorrect": true,
          "explanation": "Reducer must always return state."
        },
        {
          "id": "b",
          "text": "useReducer is wrong",
          "isCorrect": false,
          "explanation": "Hook usage is fine."
        }
      ],
      "lesson": "Reducer must always return state."
    },

    "task": {
      "type": "coding-task",
      "title": "Light Switch",
      "description": "Toggle light ON and OFF using reducer.",
      "requirements": [
        "initial state false",
        "toggle action",
        "button to dispatch"
      ],
      "starterCode": "function reducer(state, action) {\n  return state;\n}\n\nfunction Light() {\n  return null;\n}\n\nexport default Light;",
      "solution": "import { useReducer } from 'react';\n\nfunction reducer(state, action) {\n  if (action === 'toggle') {\n    return !state;\n  }\n  return state;\n}\n\nfunction Light() {\n  const [on, dispatch] = useReducer(reducer, false);\n\n  return (\n    <button onClick={() => dispatch('toggle')}>\n      {on ? 'ON' : 'OFF'}\n    </button>\n  );\n}\n\nexport default Light;"
    },

    "challenge": {
      "type": "coding-challenge",
      "title": "Cart Quantity",
      "description": "Increase and decrease cart items.",
      "requirements": [
        "useReducer",
        "add and remove actions",
        "display quantity"
      ],
      "solution": "import { useReducer } from 'react';\n\nfunction reducer(state, action) {\n  if (action === 'add') return state + 1;\n  if (action === 'remove') return state - 1;\n  return state;\n}\n\nfunction Cart() {\n  const [qty, dispatch] = useReducer(reducer, 0);\n\n  return (\n    <div>\n      <p>{qty}</p>\n      <button onClick={() => dispatch('add')}>Add</button>\n      <button onClick={() => dispatch('remove')}>Remove</button>\n    </div>\n  );\n}\n\nexport default Cart;"
    },

    "memory": {
      "type": "memory-game",
      "title": "Reducer Memory",
      "pairs": [
        { "concept": "reducer", "code": "rules" },
        { "concept": "dispatch", "code": "send action" },
        { "concept": "state", "code": "current value" },
        { "concept": "action", "code": "what to do" }
      ]
    },

    "tower": {
      "type": "tower-defense",
      "concepts": [
        {
          "question": "useReducer is best for?",
          "options": ["simple state", "complex logic", "styling", "routing"],
          "correct": 1
        },
        {
          "question": "Reducer must?",
          "options": [
            "modify state",
            "return new state",
            "call API",
            "use setState"
          ],
          "correct": 1
        }
      ],
      "waves": 3
    }
  }
}
