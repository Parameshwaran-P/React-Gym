{
  "id": "react-014-suspense",
  "title": "React Suspense",
  "description": "Learn how to use React Suspense for lazy loading and handling asynchronous components",
  "duration": 12,
  "difficulty": "advanced",
  "tags": ["suspense", "lazy-loading", "async", "react"],
  "prerequisites": ["react-013-portals"],
  "unlocks": ["react-015-final-project"],
  "xp": 95,
  "steps": {
    "refresher": {
      "type": "markdown",
      "title": "üè• Real-Life Story: Lazy-Loading Patient Data",
      "content": "# ‚ö° Suspense in Hospital App\n\nImagine our hospital dashboard has **hundreds of patients** with detailed medical histories:\n\n- Loading all patient data at once is slow\n- Doctors see a blank screen while waiting\n- We want to **show a loader** until data is ready\n\n‚ùå Problem: Without Suspense, handling loading states manually can get messy.\n\n---\n\n## üß† Why This Happens\n\n- React renders components synchronously by default\n- Async data fetching requires **manual state management** for loading, error, and success\n- This can lead to repetitive and error-prone code\n\n---\n\n## ‚úÖ React Solution: Suspense + Lazy\n\n- `React.lazy()` allows **code-splitting**: load component only when needed\n- `Suspense` provides a **fallback UI** while loading\n- Works perfectly for **modals, dashboards, or heavy components**\n\nThink of it as **hospital triage for rendering**: show a spinner while the patient data arrives."
    },
    "positive": {
      "type": "interactive-code",
      "title": "‚úÖ Positive Case: Lazy-Load Patient Dashboard",
      "description": "Use React.lazy and Suspense to load PatientDashboard component on demand.",
      "code": "import { Suspense, lazy } from 'react';\n\nconst PatientDashboard = lazy(() => import('./PatientDashboard'));\n\nfunction HospitalApp() {\n  const [showDashboard, setShowDashboard] = useState(false);\n\n  return (\n    <div className='p-6'>\n      <h1 className='text-2xl font-bold mb-4'>Hospital Dashboard</h1>\n      <button onClick={() => setShowDashboard(true)} className='px-4 py-2 bg-blue-600 text-white rounded'>View Patients</button>\n      {showDashboard && (\n        <Suspense fallback={<div className='text-center mt-4'>Loading Patient Data...</div>}>\n          <PatientDashboard />\n        </Suspense>\n      )}\n    </div>\n  );\n}\n\nexport default HospitalApp;",
      "showPreview": true,
      "explanation": "**How it works:**\n\n1. `React.lazy()` dynamically imports PatientDashboard only when needed\n2. `Suspense` wraps the lazy component with a fallback (loader) while fetching\n3. Clicking 'View Patients' triggers loading\n4. Once loaded, PatientDashboard is displayed\n\n‚úÖ **Key Rule:** Use Suspense + lazy for heavy components or pages to improve performance."
    },
    "negative": {
      "type": "debug-quiz",
      "title": "üêõ Common Mistake: Lazy Component Without Suspense",
      "description": "What happens if you use React.lazy() without wrapping the component in Suspense?",
      "code": "const PatientDashboard = React.lazy(() => import('./PatientDashboard'));\nfunction App() {\n  return <PatientDashboard />;\n}",
      "question": "Why is this a problem?",
      "options": [
        {
          "id": "a",
          "text": "It works fine without Suspense",
          "isCorrect": false,
          "explanation": "React.lazy always requires Suspense wrapper for fallback UI."
        },
        {
          "id": "b",
          "text": "React will throw an error",
          "isCorrect": true,
          "explanation": "‚úÖ Correct! Lazy-loaded components must be wrapped in Suspense."
        },
        {
          "id": "c",
          "text": "Component will render but slowly",
          "isCorrect": false,
          "explanation": "React does not allow lazy components to render without Suspense."
        },
        {
          "id": "d",
          "text": "It only affects class components",
          "isCorrect": false,
          "explanation": "Lazy loading works with functional components too; Suspense is still required."
        }
      ],
      "correctCode": "Wrap all lazy-loaded components in <Suspense fallback={<Loader />} />."
    },
    "task": {
      "type": "coding-task",
      "title": "üõ†Ô∏è Your Turn: Lazy-Load Modals",
      "description": "Implement lazy-loading for patient modals or heavy components using React.lazy and Suspense.",
      "requirements": [
        "Lazy-load PatientModal or other heavy components",
        "Use Suspense with a fallback loader",
        "Verify the modal loads correctly when triggered",
        "Ensure no errors in console"
      ],
      "starterCode": "import { lazy, Suspense } from 'react';\nconst PatientModal = lazy(() => import('./PatientModal'));\nfunction HospitalApp() { return <div>TODO</div>; }",
      "solution": "/* Wrap lazy component in Suspense as shown in Positive Case */",
      "hints": [
        "React.lazy returns a promise, Suspense shows fallback until resolved",
        "Wrap the modal call in <Suspense fallback={<Loader />} />",
        "Fallback can be simple text or spinner"
      ],
      "tests": [
        "Lazy component renders on demand",
        "Fallback is displayed while loading",
        "No console errors"
      ]
    },
    "challenge": {
      "type": "coding-challenge",
      "title": "üèÜ Challenge: Multi-Ward Lazy Loading",
      "description": "Lazy-load multiple ward dashboards or patient sections. Show fallback loaders individually for each section while loading.",
      "requirements": [
        "Each ward component is lazy-loaded",
        "Suspense fallback is specific per ward",
        "Clicking 'View Ward' triggers lazy loading",
        "Verify independent loading for multiple wards"
      ],
      "starterCode": "/* Lazy-load multiple ward components and wrap in Suspense */",
      "solution": "/* Use multiple Suspense wrappers with individual fallback loaders */",
      "hints": [
        "Each lazy component needs its own Suspense",
        "Fallback UI can differ per section",
        "Helps performance and UX for large dashboards"
      ],
      "tests": [
        "Each ward lazy-loads correctly",
        "Fallback loader appears during loading",
        "No overlapping errors or UI glitches"
      ]
    }
  }
}
