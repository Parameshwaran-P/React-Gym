{
  "id": "react-032-env",
  "title": "Environment Variables in React",
  "description": "Learn how to manage secrets and environment-specific values safely in React apps",
  "duration": 9,
  "difficulty": "intermediate",
  "tags": ["react", "env", "configuration", "security"],
  "prerequisites": ["react-031-testing"],
  "unlocks": ["react-033-build"],
  "xp": 110,

  "steps": {
    "intro": {
      "type": "game-intro",
      "title": "Hide the Secrets",
      "story": "Your API key is exposed and anyone can see it.",
      "preview": "Learn how to protect sensitive values using environment variables."
    },

    "refresher": {
      "type": "markdown",
      "title": "Real-Life Example",
      "content": "# Office Locker\n\nOnly employees have keys\n\nVisitors cannot access\n\n---\n\nEnvironment variables work like lockers for secrets."
    },

    "concept": {
      "type": "markdown",
      "title": "What Are Environment Variables?",
      "content": "Environment variables are:\n- Configuration values\n- Not hard-coded\n- Different for dev and prod\n\nExamples:\n- API URLs\n- API keys\n- Feature flags"
    },

    "concept2": {
      "type": "markdown",
      "title": "Why Not Hard-Code?",
      "content": "Hard-coding causes:\n- Security risks\n- Difficult deployments\n- Bugs in production\n\nEnvironment variables solve this."
    },

    "concept3": {
      "type": "markdown",
      "title": "How React Handles Env",
      "content": "Rules:\n- Stored in `.env` file\n- Must start with `VITE_` (Vite)\n- Must restart server after change"
    },

    "syntax": {
      "type": "markdown",
      "title": "Basic Syntax (Vite)",
      "content": "```\nVITE_API_URL=https://api.example.com\n```\n\nUsage:\n```\nconst url = import.meta.env.VITE_API_URL;\n```"
    },

    "positive": {
      "type": "interactive-code",
      "title": "Using Env Variable",
      "description": "Access API URL safely.",
      "code": "const apiUrl = import.meta.env.VITE_API_URL;\n\nfunction FetchData() {\n  return <p>{apiUrl}</p>;\n}\n\nexport default FetchData;",
      "showPreview": true,
      "explanation": "Value changes without touching code."
    },

    "concept4": {
      "type": "markdown",
      "title": "Multiple Environments",
      "content": "Common files:\n- `.env.development`\n- `.env.production`\n\nEach environment loads automatically."
    },

    "negative": {
      "type": "debug-quiz",
      "title": "Env Not Working",
      "description": "Value is undefined.",
      "code": "console.log(import.meta.env.API_URL);",
      "question": "What is the issue?",
      "options": [
        {
          "id": "a",
          "text": "Missing VITE_ prefix",
          "isCorrect": true,
          "explanation": "Vite exposes only VITE_ variables."
        },
        {
          "id": "b",
          "text": "React bug",
          "isCorrect": false,
          "explanation": "Framework is working fine."
        }
      ],
      "lesson": "Always prefix env variables correctly."
    },

    "task": {
      "type": "coding-task",
      "title": "API Config",
      "description": "Setup API base URL using env.",
      "requirements": [
        "Create env variable",
        "Access in component",
        "Display value"
      ],
      "starterCode": "function Api() {\n  return null;\n}\n\nexport default Api;",
      "solution": "function Api() {\n  const baseUrl = import.meta.env.VITE_API_URL;\n\n  return <p>{baseUrl}</p>;\n}\n\nexport default Api;"
    },

    "challenge": {
      "type": "coding-challenge",
      "title": "Feature Flag",
      "description": "Enable or disable feature using env.",
      "requirements": [
        "Boolean env variable",
        "Conditional rendering",
        "No hard-coded value"
      ],
      "solution": "Use import.meta.env to toggle features based on environment."
    },

    "memory": {
      "type": "memory-game",
      "title": "Env Memory",
      "pairs": [
        { "concept": "VITE_", "code": "required prefix" },
        { "concept": ".env", "code": "config file" },
        { "concept": "restart", "code": "apply changes" },
        { "concept": "security", "code": "hide secrets" }
      ]
    },

    "tower": {
      "type": "tower-defense",
      "concepts": [
        {
          "question": "Env files are used for?",
          "options": ["styles", "logic", "config", "routing"],
          "correct": 2
        },
        {
          "question": "Vite exposes which vars?",
          "options": ["all", "REACT_", "VITE_", "ENV_"],
          "correct": 2
        }
      ],
      "waves": 3
    }
  }
}
