{
  "id": "react-038-common-mistakes",
  "title": "Common React Mistakes",
  "description": "Avoid the most frequent errors developers make in React projects",
  "duration": 7,
  "difficulty": "advanced",
  "tags": ["react", "mistakes", "debugging"],
  "prerequisites": ["react-037-best-practices"],
  "unlocks": ["react-039-interview"],
  "xp": 150,

  "steps": {
    "intro": {
      "type": "game-intro",
      "title": "Learning From Mistakes",
      "story": "Every bug teaches a lesson. Smart developers learn faster.",
      "preview": "Real mistakes seen in real projects."
    },

    "mistake1": {
      "type": "markdown",
      "title": "Mutating State Directly",
      "content": "React state must be treated as immutable.\n\nWrong:\nstate.count++\n\nRight:\nsetCount(prev => prev + 1)"
    },

    "mistake2": {
      "type": "markdown",
      "title": "Missing Dependency Array",
      "content": "useEffect without dependencies can cause infinite loops or missed updates."
    },

    "quiz1": {
      "type": "debug-quiz",
      "title": "Find the Bug",
      "description": "Why is this code problematic?",
      "code": "useEffect(() => {\n  fetchData();\n});",
      "question": "What is wrong?",
      "options": [
        {
          "id": "a",
          "text": "Missing dependency array",
          "isCorrect": true,
          "explanation": "Effect runs on every render."
        },
        {
          "id": "b",
          "text": "fetchData cannot be async",
          "isCorrect": false,
          "explanation": "Async functions are allowed."
        }
      ]
    },

    "mistake3": {
      "type": "markdown",
      "title": "Using Index as Key",
      "content": "Using array index as key breaks reconciliation when items change."
    },

    "mistake4": {
      "type": "markdown",
      "title": "Overusing Global State",
      "content": "Not everything belongs in Redux or Context."
    },

    "mistake5": {
      "type": "markdown",
      "title": "Unnecessary Re-renders",
      "content": "Inline functions and objects can trigger re-renders."
    },

    "task": {
      "type": "coding-task",
      "title": "Fix the Mistakes",
      "description": "Correct common React issues.",
      "requirements": [
        "Avoid state mutation",
        "Fix useEffect dependencies",
        "Use stable keys"
      ],
      "starterCode": "items.map((item, index) => <Item key={index} />)",
      "solution": "Use unique IDs instead of index"
    },

    "challenge": {
      "type": "coding-challenge",
      "title": "Performance Cleanup",
      "description": "Reduce unnecessary re-renders.",
      "requirements": [
        "Use React.memo",
        "Use useCallback",
        "Avoid inline objects"
      ],
      "solution": "Memoize components and functions"
    },

    "memory": {
      "type": "memory-game",
      "title": "Mistake Patterns",
      "pairs": [
        { "concept": "state mutation", "fix": "immutable updates" },
        { "concept": "useEffect bug", "fix": "dependency array" },
        { "concept": "index key", "fix": "unique id" },
        { "concept": "global state abuse", "fix": "local state" }
      ]
    },

    "tower": {
      "type": "tower-defense",
      "concepts": [
        {
          "question": "Why not mutate state?",
          "options": [
            "React ignores it",
            "Breaks rendering",
            "Slows CSS",
            "No reason"
          ],
          "correct": 1
        },
        {
          "question": "Best key choice?",
          "options": [
            "Index",
            "Random",
            "Unique id",
            "Component name"
          ],
          "correct": 2
        }
      ],
      "waves": 3
    }
  }
}
