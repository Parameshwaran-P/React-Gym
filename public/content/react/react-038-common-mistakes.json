{
  "id": "react-038-common-mistakes",
  "title": "Common React Mistakes",
  "description": "Identify, understand, and avoid the most common mistakes React developers make in real projects",
  "duration": 14,
  "difficulty": "advanced",
  "tags": ["react", "mistakes", "debugging", "best-practices"],
  "prerequisites": ["react-037-best-practices"],
  "unlocks": ["react-039-interview"],
  "xp": 150,

  "steps": {
    "intro": {
      "type": "game-intro",
      "title": "Why Good Apps Fail",
      "story": "Most bugs are not advanced problems. They are small mistakes repeated everywhere.",
      "preview": "Learn to spot mistakes before they reach production."
    },

    "refresher": {
      "type": "markdown",
      "title": "Reality of Real Projects",
      "content": "# Industry Truth\n\nMost production issues come from:\n\n- Wrong state placement\n- Bad component structure\n- Ignoring performance\n- Poor error handling\n\n---\n\nAvoiding mistakes is a senior skill."
    },

    "concept": {
      "type": "markdown",
      "title": "Mistake 1: Overusing State",
      "content": "Common error:\n\n- Storing derived values in state\n- Updating state unnecessarily\n\nRule:\nIf value can be calculated, do not store it."
    },

    "negative": {
      "type": "debug-quiz",
      "title": "Derived State Bug",
      "description": "Unnecessary state usage.",
      "code": "const [total, setTotal] = useState(price * qty);",
      "question": "What is wrong here?",
      "options": [
        {
          "id": "a",
          "text": "Derived value stored in state",
          "isCorrect": true,
          "explanation": "Derived values should be calculated directly."
        },
        {
          "id": "b",
          "text": "useState is slow",
          "isCorrect": false,
          "explanation": "The issue is misuse, not performance."
        }
      ],
      "lesson": "State should store source of truth only."
    },

    "concept2": {
      "type": "markdown",
      "title": "Mistake 2: Props Drilling Everywhere",
      "content": "Symptoms:\n\n- Passing props through many layers\n- Components depend on unrelated data\n\nFix:\n- Lift state wisely\n- Use context or store when needed"
    },

    "concept3": {
      "type": "markdown",
      "title": "Mistake 3: Large Components",
      "content": "Large components usually:\n\n- Handle UI\n- Handle logic\n- Handle API\n- Handle state\n\nThis makes debugging painful."
    },

    "positive": {
      "type": "interactive-code",
      "title": "Smaller Components",
      "description": "Split responsibilities.",
      "code": "function UserProfile({ user }) {\n  return (\n    <div>\n      <Avatar user={user} />\n      <UserDetails user={user} />\n    </div>\n  );\n}\n\nexport default UserProfile;",
      "showPreview": false,
      "explanation": "Small components are easier to test and reuse."
    },

    "concept4": {
      "type": "markdown",
      "title": "Mistake 4: useEffect Abuse",
      "content": "Common misuse:\n\n- Using useEffect for everything\n- Missing dependency array\n- Infinite loops\n\nRule:\nuseEffect is not a replacement for logic."
    },

    "negative2": {
      "type": "debug-quiz",
      "title": "Infinite Loop",
      "description": "Effect runs endlessly.",
      "code": "useEffect(() => {\n  setCount(count + 1);\n});",
      "question": "Why does this loop?",
      "options": [
        {
          "id": "a",
          "text": "Missing dependency array",
          "isCorrect": true,
          "explanation": "Effect runs after every render."
        },
        {
          "id": "b",
          "text": "setState is broken",
          "isCorrect": false,
          "explanation": "Logic error causes the loop."
        }
      ],
      "lesson": "Always understand effect dependencies."
    },

    "concept5": {
      "type": "markdown",
      "title": "Mistake 5: Ignoring Keys",
      "content": "Using index as key causes:\n\n- Wrong UI updates\n- Unexpected bugs\n\nKeys must be stable and unique."
    },

    "concept6": {
      "type": "markdown",
      "title": "Mistake 6: Premature Optimization",
      "content": "Using memo, useCallback everywhere:\n\n- Increases complexity\n- Adds bugs\n\nOptimize only when needed."
    },

    "task": {
      "type": "coding-task",
      "title": "Fix the Component",
      "description": "Refactor a buggy component.",
      "requirements": [
        "Remove unnecessary state",
        "Fix useEffect",
        "Split components",
        "Improve keys"
      ],
      "starterCode": "function BuggyComponent() {\n  return null;\n}",
      "solution": "Apply correct patterns learned."
    },

    "challenge": {
      "type": "coding-challenge",
      "title": "Mistake Spotting",
      "description": "Review a React file.",
      "requirements": [
        "Identify at least 5 mistakes",
        "Explain why they are mistakes",
        "Suggest correct approach"
      ],
      "solution": "Think like a code reviewer."
    },

    "memory": {
      "type": "memory-game",
      "title": "Mistakes Memory",
      "pairs": [
        { "concept": "Derived State", "code": "do not store" },
        { "concept": "Props Drilling", "code": "avoid deep passing" },
        { "concept": "useEffect", "code": "not for everything" },
        { "concept": "Keys", "code": "stable and unique" }
      ]
    },

    "tower": {
      "type": "tower-defense",
      "concepts": [
        {
          "question": "Most common React bug?",
          "options": ["syntax error", "state misuse", "css issue", "routing"],
          "correct": 1
        },
        {
          "question": "Best fix for large components?",
          "options": [
            "add comments",
            "split responsibilities",
            "use memo",
            "move to redux"
          ],
          "correct": 1
        }
      ],
      "waves": 3
    }
  }
}
