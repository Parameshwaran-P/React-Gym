{
  "id": "react-031-testing",
  "title": "Testing React Applications",
  "description": "Learn how to test React components to ensure reliability and prevent bugs",
  "duration": 11,
  "difficulty": "advanced",
  "tags": ["react", "testing", "jest", "react-testing-library"],
  "prerequisites": ["react-030-performance"],
  "unlocks": ["react-032-env"],
  "xp": 150,

  "steps": {
    "intro": {
      "type": "game-intro",
      "title": "Does It Really Work?",
      "story": "Your app works today, but breaks tomorrow after a small change.",
      "preview": "Learn how testing protects your app from bugs."
    },

    "refresher": {
      "type": "markdown",
      "title": "Real-Life Example",
      "content": "# ATM Machine\n\nYou test withdraw\n\nYou test deposit\n\nYou test wrong pin\n\n---\n\nTesting ensures nothing breaks unexpectedly."
    },

    "concept": {
      "type": "markdown",
      "title": "What Is Testing?",
      "content": "Testing means:\n- Checking expected output\n- Catching bugs early\n- Making code reliable\n- Refactoring with confidence"
    },

    "concept2": {
      "type": "markdown",
      "title": "Why Testing Matters",
      "content": "Without testing:\n- Bugs reach users\n- Changes break features\n- Fear of refactoring\n\nWith testing:\n- Safe changes\n- Stable apps\n- Professional codebase"
    },

    "concept3": {
      "type": "markdown",
      "title": "Types of Tests",
      "content": "Common test types:\n- Unit tests\n- Component tests\n- Integration tests\n\nIn React, we mostly test components."
    },

    "concept4": {
      "type": "markdown",
      "title": "Tools We Use",
      "content": "Popular tools:\n- Jest (test runner)\n- React Testing Library (UI testing)\n\nFocus on testing user behavior, not implementation."
    },

    "syntax": {
      "type": "markdown",
      "title": "Basic Test Syntax",
      "content": "```\ntest('description', () => {\n  render(<Component />);\n  expect(screen.getByText('Hello')).toBeInTheDocument();\n});\n```"
    },

    "positive": {
      "type": "interactive-code",
      "title": "Testing a Button Click",
      "description": "Test if count increases on click.",
      "code": "import { render, screen, fireEvent } from '@testing-library/react';\nimport Counter from './Counter';\n\ntest('increments count', () => {\n  render(<Counter />);\n\n  fireEvent.click(screen.getByText('Add'));\n\n  expect(screen.getByText('1')).toBeInTheDocument();\n});",
      "showPreview": false,
      "explanation": "Test checks user interaction and result."
    },

    "concept5": {
      "type": "markdown",
      "title": "Testing Philosophy",
      "content": "Test like a user:\n- Click buttons\n- Read text\n- Fill inputs\n\nAvoid testing internal state."
    },

    "negative": {
      "type": "debug-quiz",
      "title": "Bad Test Practice",
      "description": "Test is fragile and fails often.",
      "code": "expect(component.state.count).toBe(1);",
      "question": "What is wrong?",
      "options": [
        {
          "id": "a",
          "text": "Testing internal state",
          "isCorrect": true,
          "explanation": "User does not see internal state."
        },
        {
          "id": "b",
          "text": "Jest is broken",
          "isCorrect": false,
          "explanation": "Tool is fine."
        }
      ],
      "lesson": "Test behavior, not implementation."
    },

    "task": {
      "type": "coding-task",
      "title": "Test a Toggle",
      "description": "Test light ON and OFF behavior.",
      "requirements": [
        "Render component",
        "Click toggle button",
        "Check text change"
      ],
      "starterCode": "test('toggle works', () => {\n\n});",
      "solution": "import { render, screen, fireEvent } from '@testing-library/react';\nimport Light from './Light';\n\ntest('toggle works', () => {\n  render(<Light />);\n\n  fireEvent.click(screen.getByText('OFF'));\n  expect(screen.getByText('ON')).toBeInTheDocument();\n});"
    },

    "challenge": {
      "type": "coding-challenge",
      "title": "Form Validation Test",
      "description": "Test form error message.",
      "requirements": [
        "Submit empty form",
        "Check error text",
        "Simulate user input"
      ],
      "solution": "Use fireEvent or userEvent to simulate typing and submission, then assert error messages."
    },

    "memory": {
      "type": "memory-game",
      "title": "Testing Memory",
      "pairs": [
        { "concept": "Jest", "code": "test runner" },
        { "concept": "RTL", "code": "UI testing" },
        { "concept": "render", "code": "mount component" },
        { "concept": "fireEvent", "code": "simulate action" }
      ]
    },

    "tower": {
      "type": "tower-defense",
      "concepts": [
        {
          "question": "Best testing approach?",
          "options": ["test state", "test UI", "test CSS", "test console"],
          "correct": 1
        },
        {
          "question": "Main goal of testing?",
          "options": ["more code", "avoid bugs", "faster UI", "better CSS"],
          "correct": 1
        }
      ],
      "waves": 3
    }
  }
}
